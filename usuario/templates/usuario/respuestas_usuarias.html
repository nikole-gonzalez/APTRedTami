{% extends 'base.html' %}
{% load static %}

{% block title %}Mis Respuestas a Cuestionarios{% endblock %}

{% block content %}
<section class="wrapper">
    <div class="inner">
        <h2 class="major">Mis Respuestas al cuestionario</h2>
        
        <!-- TM -->
        <h3>Preguntas de tamizaje</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Pregunta</th>
                        <th>Respuesta</th>
                        <th>Fecha Respuesta</th>
                    </tr>
                </thead>
                <tbody>
                    {% for respuesta in respuestas_tm %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ respuesta.id_opc_tm.id_preg_tm.preg_tm }}</td>
                        <td>{{ respuesta.id_opc_tm.opc_resp_tm }}</td>
                        <td>{{ respuesta.fecha_respuesta_tm|date:"d-m-Y H:i:s" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4">No hay respuestas para este cuestionario</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

                <!-- FRNM -->
        <h3>Factores de riesgo no modificables</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Pregunta</th>
                        <th>Respuesta</th>
                        <th>Fecha Respuesta</th>
                    </tr>
                </thead>
                <tbody>
                    {% for respuesta in respuestas_frnm %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ respuesta.id_opc_frnm.id_preg_frnm.preg_frnm }}</td>
                        <td>{{ respuesta.id_opc_frnm.opc_resp_frnm }}</td>
                        <td>{{ respuesta.fecha_respuesta_frnm|date:"d-m-Y H:i:s" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4">No hay respuestas para este cuestionario</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- FRM -->
        <h3>Factores de riesgo modificables</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Pregunta</th>
                        <th>Respuesta</th>
                        <th>Fecha Respuesta</th>
                    </tr>
                </thead>
                <tbody>
                    {% for respuesta in respuestas_frm %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ respuesta.id_opc_frm.id_preg_frm.preg_frm }}</td>
                        <td>{{ respuesta.id_opc_frm.opc_resp_frm }}</td>
                        <td>{{ respuesta.fecha_respuesta_frm|date:"d-m-Y H:i:s" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4">No hay respuestas para este cuestionario</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- DS -->
        <h3>Determinantes sociales de la salud</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Pregunta</th>
                        <th>Respuesta</th>
                        <th>Fecha Respuesta</th>
                    </tr>
                </thead>
                <tbody>
                    {% for respuesta in respuestas_ds %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ respuesta.id_opc_ds.id_preg_ds.preg_ds }}</td>
                        <td>{{ respuesta.id_opc_ds.opc_resp_ds }}</td>
                        <td>{{ respuesta.fecha_respuesta_ds|date:"d-m-Y H:i:s" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4">No hay respuestas para este cuestionario</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Preguntas Textuales -->
        <h3>Consulta a especialista o comentario</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Pregunta</th>
                        <th>Fecha</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pregunta in preguntas_textuales %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ pregunta.texto_pregunta }}</td>
                        <td>{{ pregunta.fecha_pregunta_texto|date:"d-m-Y H:i:s" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="3">No hay preguntas textuales registradas</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <section class="actions">
            <ul class="actions stacked">
                <li><a href="{% url 'usuario_index' %}" class="button primary fit">Volver</a></li>
            </ul>
        </section>
    </div>
</section>

<style>
    .table-wrapper {
        overflow-x: auto;
        margin-bottom: 40px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
    }
    
    th, td {
        padding: 12px 15px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    
    th {
        background-color: #f2849e;
        color: white;
        font-weight: bold;
    }
    
    tr:hover {
        background-color: #f5f5f5;
    }
    
    .actions {
        margin-top: 30px;
    }
    
    h3 {
        color: #f2849e;
        margin-top: 30px;
    }
</style>
{% endblock %}